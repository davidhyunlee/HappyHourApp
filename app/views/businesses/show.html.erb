<div class="menubar">
  <div class="ui secondary  menu">
    <a class="active item">
      <i class="home icon"></i> Home
    </a>
    <a class="item">
      <i class="mail icon"></i> Messages
    </a>
    <a class="item">
      <i class="user icon"></i> Friends
    </a>
    <div class="right menu">
      <div class="item">
        <div class="ui icon input">
          <input type="text" placeholder="Search...">
          <i class="search link icon"></i>
        </div>
      </div>
      <a class="ui item">
        Logout
      </a>
    </div>
  </div>
</div>

<div class="ui grid">
  <div class="ten wide column">
    <div class="photo_business"><%= image_tag @business.photos[@business.photos.length-2].photo.url %></div>

    <h1 class="normalize"><%= @business.name %></h1>
    <%= @business.address %><br>
    <%= @business.address_2 %><br>
    <%= @business.city %><br>
    <%= @business.state %><br>
    <%= @business.zip %>

  </div>
  <div class="six wide column">
    <div id="map-canvas">
    </div>
  </div>
</div>

<hr>

<div class="ui grid">
  <div class="eleven wide column">
  <h1 class="normalize">REVIEWS</h1>

    <div class="ui comments">
      <% @business.reviews.each do |review| %>
      <div class="comment">
        <a class="avatar">
          <%= image_tag review.user.photo.url %>
        </a>
        <div class="content">
          <a class="author"><%= "#{User.find(review.user_id.to_i).first_name} #{User.find(review.user_id.to_i).last_name}" unless review.user_id.to_i == 0 %></a>
          <div class="metadata">
            <div class="title"><%= review.title %></div>
          </div>
          <div class="text">
            <%= simple_format(review.body) %>
          </div>
          <div class="actions">
            <a class="reply"><%= "Posted " + time_ago_in_words(review.created_at) + " ago." unless review.created_at.blank? %></a>
          </div>
        </div>
      </div>
      <% end %>
    </div>

  </div>
  <div class="five wide column">
    <div class="business_detail_column">
    Hours go here
    </div>
  </div>
</div>








<%= form_for ([@business, Review.new]) do |f| %>

  <%= f.text_field :title %>
  <%= f.text_field :rating %>
	<%= f.text_area :body %>
	<%= f.submit "Add Review", class: "tiny button radius" %>

<% end %>

<button class="test">Press Me</button>

<div class="ui modal">
 <i class="close icon"></i>
 <div class="header">
   Upload a Photo for <%= @business.name %>
 </div>
 <div class="content">
   <div class="image">
     An image can appear on left or an icon
   </div>
   <div class="description">
    <%= form_for [@business, Photo.new] do |f| %>
      <label>Photo:</label> <%= f.file_field :photo %>
      Caption: <%= f.text_field :caption %>
      <%= f.submit "Add Photo" %>
    <% end %>
   </div>
 </div>
 <div class="actions">
   <div class="ui button">Cancel</div>
   <div class="ui button">OK</div>
 </div>
</div>

<script type="text/javascript" src="<%= @endpoint %>"></script>

<script type="text/javascript">
// this is what initializes the Google maps into our app
  function initialize() {



    var sanJose = new google.maps.LatLng(37.339085, -121.8914807);

    var beaches = [
         ['Huntington Beach', 33.660297, -117.99922650000002],
         ['Seal Beach', 33.7414064, -118.10478660000001],
         ['Long Beach', 33.7700504, -118.19373949999999],
         ['Venice Beach', 33.9850469, -118.46948320000001],
         ['Manhattan Beach', 33.8847361, -118.41090889999998]
      ];


    var mark = [];

    for (x in beaches) {

      mark[x] = new google.maps.Marker({
        position: new google.maps.LatLng(beaches[x][1], beaches[x][2]),
        title: beaches[x][0],
        animation: google.maps.Animation.DROP,
        draggable: true
      });

      google.maps.event.addListener(mark[x], 'click', function() {
        this.setAnimation(google.maps.Animation.BOUNCE);
      });
    }


    var marker = new google.maps.Marker({
      position: sanJose,
      title: "Hello World!",
      animation: google.maps.Animation.DROP,
      draggable: true
    });

    // This will make our marker bounce up and down on click
    google.maps.event.addListener(marker, 'click', function() {
      marker.setAnimation(google.maps.Animation.BOUNCE);
    });
    

    // this is going to be the styling for my map
    var styles = [{"featureType":"landscape.man_made","elementType":"geometry","stylers":[{"color":"#f7f1df"}]},{"featureType":"landscape.natural","elementType":"geometry","stylers":[{"color":"#d0e3b4"}]},{"featureType":"landscape.natural.terrain","elementType":"geometry","stylers":[{"visibility":"off"}]},{"featureType":"poi","elementType":"labels","stylers":[{"visibility":"off"}]},{"featureType":"poi.business","elementType":"all","stylers":[{"visibility":"off"}]},{"featureType":"poi.medical","elementType":"geometry","stylers":[{"color":"#fbd3da"}]},{"featureType":"poi.park","elementType":"geometry","stylers":[{"color":"#bde6ab"}]},{"featureType":"road","elementType":"geometry.stroke","stylers":[{"visibility":"off"}]},{"featureType":"road","elementType":"labels","stylers":[{"visibility":"off"}]},{"featureType":"road.highway","elementType":"geometry.fill","stylers":[{"color":"#ffe15f"}]},{"featureType":"road.highway","elementType":"geometry.stroke","stylers":[{"color":"#efd151"}]},{"featureType":"road.arterial","elementType":"geometry.fill","stylers":[{"color":"#ffffff"}]},{"featureType":"road.local","elementType":"geometry.fill","stylers":[{"color":"black"}]},{"featureType":"transit.station.airport","elementType":"geometry.fill","stylers":[{"color":"#cfb2db"}]},{"featureType":"water","elementType":"geometry","stylers":[{"color":"#a2daf2"}]}];

      // This sets the styling for a map
      var styledMap = new google.maps.StyledMapType(styles, {name: 'Styled Map'});

    // gives us predefined options in our map
    var mapOptions = {
      center: sanJose,
      zoom: 8
    };

    // it creates the map
    var map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);

    // this adds the styling into my map
    map.mapTypes.set('map_style', styledMap);
    map.setMapTypeId('map_style');
    marker.setMap(map);

    for (x in mark) {
      mark[x].setMap(map);
    }

  }

  // Loads in Google maps on window load
  google.maps.event.addDomListener(window, 'load', initialize);

</script>